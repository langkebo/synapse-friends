# Synapse Matrix 服务器环境变量配置 - Supabase 版本
# 复制此文件为 .env 并修改相应值

# ===========================================
# 基本服务器配置
# ===========================================

# 你的 Matrix 服务器域名
SYNAPSE_SERVER_NAME=matrix.yourdomain.com

# 是否向 matrix.org 报告统计信息
REPORT_STATS=no

# 是否启用用户注册
ENABLE_REGISTRATION=false

# 最大上传文件大小
MAX_UPLOAD_SIZE=50M

# ===========================================
# Supabase 数据库配置
# ===========================================

# Supabase 项目信息
SUPABASE_URL=https://gomidmecjarcriccnvyc.supabase.co
SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdvbWlkbWVjamFyY3JpY2NudnljIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ4MTI4ODYsImV4cCI6MjA3MDM4ODg4Nn0.m-VxIB-wBq7kEZVKstqFt6XWjplpfFuxFd_kIQODHQU
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key_here

# Supabase 数据库连接信息
# 从 Supabase 项目设置 -> 数据库 -> 连接信息中获取
SUPABASE_DB_HOST=db.gomidmecjarcriccnvyc.supabase.co
SUPABASE_DB_PORT=5432
SUPABASE_DB_USER=postgres
SUPABASE_DB_PASSWORD=your_supabase_db_password
SUPABASE_DB_NAME=postgres

# ===========================================
# Redis 缓存配置（推荐启用）
# ===========================================

# 是否启用 Redis 缓存
REDIS_ENABLED=true
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=your_secure_redis_password

# ===========================================
# 安全密钥配置
# ===========================================

# 用户注册共享密钥（用于创建管理员账户）
REGISTRATION_SHARED_SECRET=your_registration_secret_key_here

# Macaroon 密钥（用于访问令牌）
MACARRON_SECRET_KEY=your_macaroon_secret_key_here

# 表单密钥（用于 CSRF 保护）
FORM_SECRET=your_form_secret_key_here

# ===========================================
# 好友管理功能配置
# ===========================================

# 是否启用好友功能
FRIENDS_ENABLED=true

# 每个用户最大好友数量
MAX_FRIENDS_PER_USER=1000

# 好友请求超时时间（秒）
FRIEND_REQUEST_TIMEOUT=604800

# 是否允许跨域好友关系
ALLOW_CROSS_DOMAIN_FRIENDS=true

# ===========================================
# 性能配置
# ===========================================

# 缓存因子（0.1-2.0，越高占用内存越多但性能越好）
CACHE_FACTOR=0.5

# ===========================================
# 邮件配置（可选）
# ===========================================

# SMTP 服务器配置
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your_email@gmail.com
SMTP_PASS=your_email_password

# ===========================================
# Element Web 客户端配置（可选）
# ===========================================

# Element Web 版本
ELEMENT_WEB_VERSION=latest

# 默认服务器
ELEMENT_DEFAULT_SERVER=https://matrix.yourdomain.com

# ===========================================
# Coturn TURN 服务器配置（可选，用于 VoIP）
# ===========================================

# TURN 服务器端口范围
COTURN_MIN_PORT=49152
COTURN_MAX_PORT=65535

# TURN 服务器认证密钥
COTURN_STATIC_AUTH_SECRET=your_coturn_secret_key

# TURN 服务器域名
COTURN_REALM=matrix.yourdomain.com

# ===========================================
# 监控配置（可选）
# ===========================================

# Prometheus 端口
PROMETHEUS_PORT=9090

# Grafana 端口和管理员密码
GRAFANA_PORT=3000
GRAFANA_ADMIN_PASSWORD=your_secure_grafana_password

# ===========================================
# SSL/TLS 配置
# ===========================================

# SSL 证书路径（容器内路径）
SSL_CERT_PATH=/ssl/fullchain.pem
SSL_KEY_PATH=/ssl/privkey.pem

# ===========================================
# 日志配置
# ===========================================

# 日志级别 (DEBUG, INFO, WARNING, ERROR)
LOG_LEVEL=INFO

# 日志文件路径
LOG_FILE=/logs/homeserver.log

# ===========================================
# 时区配置
# ===========================================

# 服务器时区
TZ=Asia/Shanghai

# ===========================================
# 高级配置
# ===========================================

# 工作进程数量（通常等于 CPU 核心数）
WORKER_PROCESSES=1

# 数据库连接池大小
DB_CP_MIN=5
DB_CP_MAX=20

# 媒体存储路径
MEDIA_STORE_PATH=/data/media_store

# 签名密钥路径
SIGNING_KEY_PATH=/data/signing.key

# ===========================================
# 开发/调试配置
# ===========================================

# 是否启用调试模式
DEBUG=false

# 是否启用详细日志
VERBOSE_LOGGING=false

# ===========================================
# 注意事项
# ===========================================

# 1. 请确保所有密钥都是随机生成的强密码
# 2. 生成密钥的命令：openssl rand -hex 32
# 3. Supabase 数据库信息可在项目设置中找到
# 4. 域名需要正确配置 DNS 解析
# 5. 如果使用 SSL，请确保证书文件存在
# 6. Redis 密码建议使用强密码
# 7. 生产环境建议禁用用户注册